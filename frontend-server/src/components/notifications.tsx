import Notification from "./notification";
import { NotificationType } from "../types";
import { useAppDispatch } from "./hooks";
import { readAllNotification } from "./store/api-actions/patch-action";

type NotificationsProps = {
    notificationsList: NotificationType[]
    onClickExit: () => void
    isOpen: boolean
}

function Notifications({notificationsList, isOpen, onClickExit}: NotificationsProps){
    const dispatch = useAppDispatch()
    function readAllNotifications(){
        dispatch(readAllNotification())
    }

    return ( 
        <div className="notification-block" style={{
            opacity: !isOpen ? "0" : "1",
            transition: "all .5s",
            visibility: !isOpen ? "hidden" : "visible",
          }}>
            <div className="read-all-notifications">
                <svg onClick={readAllNotifications} width="27" height="26" viewBox="0 0 27 26" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <g id="Group 198">
                        <path id="Vector" d="M13.5872 0.142122C13.798 0.0250452 14.0467 -0.021829 14.2911 0.00945737L15.3783 0.147325C15.623 0.178839 15.8482 0.286783 16.0155 0.452781C16.1828 0.618779 16.2819 0.832573 16.2959 1.05777L16.3558 1.99943C16.3735 2.28368 16.4593 2.56093 16.607 2.81169C16.7547 3.06246 16.9608 3.28065 17.2107 3.45094L17.604 3.71757C19.2711 4.68593 20.484 6.1857 21.0067 7.92513L19.1372 9.63156L18.7653 9.2908C18.3696 8.92955 17.8997 8.64299 17.3826 8.44749C16.8655 8.25198 16.3113 8.15136 15.7516 8.15136C15.1919 8.15136 14.6377 8.25198 14.1206 8.44749C13.6035 8.64299 13.1337 8.92955 12.7379 9.2908C11.9386 10.0204 11.4896 11.0099 11.4896 12.0416C11.4896 13.0734 11.9386 14.0629 12.7379 14.7925L15.8813 17.6617C16.2827 18.0919 16.7818 18.4372 17.3441 18.6737C17.9063 18.9102 18.5182 19.0322 19.1372 19.0313C19.9848 19.0342 20.8139 18.806 21.5183 18.3757C21.7463 18.831 22.0583 19.2472 22.4402 19.6061L22.8848 20.0236C23.173 20.2951 23.3686 20.6372 23.4478 21.0083C23.5269 21.3793 23.4863 21.7634 23.3308 22.1138L23.3023 22.1788C23.145 22.5337 22.8622 22.8304 22.4989 23.0217C22.1357 23.2131 21.7128 23.2881 21.2974 23.2349L17.3646 22.7303C17.1837 23.7361 16.5788 24.6373 15.6793 25.2412C14.7798 25.8452 13.6571 26.1039 12.5513 25.962C11.4455 25.8201 10.4444 25.2889 9.76219 24.482C9.07995 23.6751 8.7707 22.6566 8.90058 21.6442L1.62919 20.7117C1.21361 20.6587 0.829378 20.4804 0.537613 20.2051C0.245848 19.9298 0.0633053 19.5734 0.0190217 19.1925L0.0118969 19.1236C-0.0317678 18.7474 0.045332 18.3677 0.233809 18.0308C0.422287 17.6939 0.714011 17.4143 1.07347 17.226L1.62634 16.9346C2.18356 16.6426 2.67101 16.2516 3.0599 15.7847C3.44879 15.3178 3.73123 14.7845 3.89054 14.2163L5.61755 8.04999C5.95851 6.83034 6.64077 5.71247 7.59748 4.80593C8.55418 3.89939 9.7525 3.23527 11.075 2.87866L11.531 2.72258C11.8228 2.62186 12.0869 2.46406 12.3047 2.26027C12.5226 2.05647 12.6889 1.81162 12.7921 1.54291L13.134 0.651972C13.216 0.439339 13.3761 0.25918 13.5872 0.142122Z" fill="white"/>
                        <path id="Vector_2" d="M26.6898 9.62878C26.694 10.0574 26.5202 10.4722 26.2093 10.7808L20.2108 16.5204C19.8865 16.8288 19.4512 17.001 18.9983 17C18.5447 17 18.1081 16.8277 17.7873 16.5204L14.3592 13.2407C14.2052 13.0886 14.0836 12.9085 14.0012 12.7106C13.9187 12.5127 13.8771 12.3009 13.8787 12.0872C13.8829 11.6573 14.0624 11.2466 14.3804 10.9434C14.7004 10.6377 15.1295 10.4649 15.5775 10.4613C16.0255 10.4577 16.4575 10.6236 16.7826 10.9242L18.9983 13.0422L23.7859 8.46295C24.111 8.16238 24.543 7.99646 24.991 8.00006C25.439 8.00366 25.8681 8.17649 26.1881 8.48224C26.5061 8.78541 26.6855 9.19883 26.6898 9.6274V9.62878Z" fill="white"/>
                    </g>
                </svg>
                <p>Уведомления</p>
            </div>
            <div className="notification-list">
                {notificationsList.map((notification) => <Notification onClickExit={onClickExit} key={notification.id} task={notification.task} employee={notification.employee} planet={notification.planet} id={notification.id} data={notification.notification_type} date={notification.created_at} checked={notification.is_read}/>)}
            </div>
        </div>
     );
}

export default Notifications;